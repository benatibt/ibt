/* ==========================================================================
   Islands Book Trust — Block Editor helpers (editor-only)
   Goal: Match front end for widths + gutters and stop left/right floats escaping.
   Scope: .editor-styles-wrapper only (no front-end effect)
   ========================================================================== */

/* 0) Robust width variables + side gutter fallback */
.editor-styles-wrapper {
  --ibt-content-size: var(--wp--style--global--content-size,
                       var(--wp--style--root--content-size,
                       var(--wp--custom--content-size, 50rem)));
  --ibt-wide-size:    var(--wp--style--global--wide-size,
                       var(--wp--style--root--wide-size,
                       var(--wp--custom--wide-size, 80rem)));
  --ibt-side-gutter:  var(--wp--style--root--padding-left,
                       var(--wp--preset--spacing--s, 1rem));
}

/* 1) Gutters + create a new BFC so floats are contained (key fix = flow-root) */
.editor-styles-wrapper .is-root-container,
.editor-styles-wrapper .block-editor-block-list__layout.is-root-container,
.editor-styles-wrapper .is-layout-constrained,
.editor-styles-wrapper .wp-site-blocks,
.editor-styles-wrapper .wp-block-post-content {
  padding-left:  var(--ibt-side-gutter);
  padding-right: var(--ibt-side-gutter);
  box-sizing: border-box;
  display: flow-root; /* <-- prevents floated images from “escaping” the column */
}

/* 2) Image block width parity (both editors)
   - Default/center/left/right -> capped to content
   - Wide  -> capped to wide
   - Full  -> spans canvas
*/
.editor-styles-wrapper :where(.is-root-container, .wp-site-blocks, .wp-block-post-content)
  :where(figure.wp-block-image):not([data-align="wide"]):not([data-align="full"]) {
  max-width: min(100%, var(--ibt-content-size));
  margin-left: auto;
  margin-right: auto;
}
.editor-styles-wrapper :where(.is-root-container, .wp-site-blocks, .wp-block-post-content)
  :where(figure.wp-block-image)[data-align="wide"] {
  max-width: min(100%, var(--ibt-wide-size));
  margin-left: auto;
  margin-right: auto;
}
.editor-styles-wrapper :where(.is-root-container, .wp-site-blocks, .wp-block-post-content)
  :where(figure.wp-block-image)[data-align="full"] {
  max-width: none;
  width: 100%;
}

/* 3) Left/Right floats: keep a readable gap; still respect content cap */
.editor-styles-wrapper figure.wp-block-image.alignleft,
.editor-styles-wrapper figure.wp-block-image[data-align="left"]  {
  float: left;
  margin: 0 1rem 1rem 0;
}
.editor-styles-wrapper figure.wp-block-image.alignright,
.editor-styles-wrapper figure.wp-block-image[data-align="right"] {
  float: right;
  margin: 0 0 1rem 1rem;
}

/* 4) Image element: never overflow, never upscale tiny images */
.editor-styles-wrapper .wp-block-image img {
  display: block;
  height: auto;
  max-width: 100%;  /* prevent overflow of the figure */
  width: auto;      /* don't stretch small images */
  box-sizing: border-box;
}

/* 5) Optional parity: heading link underline feel from front end */
.editor-styles-wrapper :where(h1, h2, h3) a {
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 0.2em;
}
.editor-styles-wrapper :where(h1, h2, h3) a:hover,
.editor-styles-wrapper :where(h1, h2, h3) a:focus-visible {
  text-decoration-thickness: 3px;
}
